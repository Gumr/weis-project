<!-- pages/solution/netRedPlan/netRedPlan.wxml -->
<cp-nav-bar title-text="{{detail.case.tcTitle}}" backIconColor="black" home-icon="/images/backHome.png"></cp-nav-bar>
<wxs module="filters" src="../../../utils/filter.wxs"></wxs>
<!-- å¸•æ¢…æ‹‰åƒæ³• -->
<view class="pml" wx:if="{{type == '01'}}">
  <image lazy-load="{{true}}" style="width:750rpx;height:3623rpx" src="https://prodstatic.weis1606.cn/api/mini/pml-bg.png" />
</view>
<view class="celebrity {{check ? 'active' : ''}}" wx:else>
  <view class="tc-title">{{detail.case.tcTitle}}</view>
  <view class="sub-title">
    {{aimstatus[detail.case.tcTarget].name}}-{{tcComputingMethod[detail.case.tcTrialWay]}}
  </view>
  <view class="banner">
    <image src="{{detail.case.tcImgUrl}}" style="width:100%;height:100%;border-radius:10rpx" />
  </view>
  <!-- å†…å®¹ -->
  <view class="content">
    <view class="wrap-box advise">
      <view class="t-title">
        <view class="advice">å»ºè®®å±æ€§</view>
      </view>
      <view class="t-nature">
        <view class="t-row">
          <view class="num">{{sex[detail.case.tcSex].name}}</view>
          <view class="name">æ€§åˆ«</view>
        </view>
        <view class="t-row">
          <view class="num" wx:if="{{!detail.case.tcBmiSta && !detail.case.tcBmiEnd}}">--</view>
          <view class="num" wx:else>{{detail.case.tcBmiSta}}-{{detail.case.tcBmiEnd}}</view>
          <view class="name">BMI</view>
        </view>
        <view class="t-row">
          <view class="num" wx:if="{{!detail.case.tcBodyfatSta && !detail.case.tcBodyfatEnd}}">
            --
          </view>
          <view class="num" wx:else>
            {{detail.case.tcBodyfatSta}}-{{detail.case.tcBodyfatEnd}}
            <view class="unit">%</view>
          </view>
          <view class="name">ä½“è„‚ç‡</view>
        </view>
      </view>
      <view class="t-aim" wx:if="{{(detail.bmi || detail.fataRate) && ((detail.case.tcBmiSta && detail.case.tcBmiEnd) || (detail.case.tcBodyfatSta && detail.case.tcBodyfatEnd))}}">
        <image class="bg-img" src="{{(detail.bmi && detail.bmi >= detail.case.tcBmiSta && detail.bmi <= detail.case.tcBmiEnd) || (detail.fataRate && detail.fataRate >= detail.case.tcBodyfatSta && detail.fataRate <= detail.case.tcBodyfatEnd) ? 'https://prodstatic.weis1606.cn/api/mini/details_bubble_green.png' : 'https://prodstatic.weis1606.cn/api/mini/details_bubble_orange.png'}}" />
        <image class="icon" src="{{(detail.bmi && detail.bmi >= detail.case.tcBmiSta && detail.bmi <= detail.case.tcBmiEnd) || (detail.fataRate && detail.fataRate >= detail.case.tcBodyfatSta && detail.fataRate <= detail.case.tcBodyfatEnd) ? 'https://prodstatic.weis1606.cn/api/mini/template_reduction_hook_new.png' : 'https://prodstatic.weis1606.cn/api/mini/template_reduction_circular_new.png'}}" />
        <view class="aim-wrap">
          <view class="t-row" wx:if="{{detail.bmi && detail.bmi >= detail.case.tcBmiSta && detail.bmi <= detail.case.tcBmiEnd}}">
            æ»¡è¶³ä½ çš„BMI {{detail.bmi}}
          </view>
          <view class="t-row active" wx:if="{{detail.bmi && (detail.bmi < detail.case.tcBmiSta || detail.bmi > detail.case.tcBmiEnd)}}">
            ä½ çš„BMI {{detail.bmi}}
          </view>
          <view class="t-row" wx:if="{{detail.fataRate && detail.fataRate >= detail.case.tcBodyfatSta && detail.fataRate <= detail.case.tcBodyfatEnd}}">
            æ»¡è¶³ä½ çš„ä½“è„‚ç‡ {{detail.fataRate}}%
          </view>
          <view class="t-row active" wx:if="{{detail.fataRate && (detail.fataRate < detail.case.tcBodyfatSta || detail.fataRate > detail.case.tcBodyfatEnd)}}">
            ä½ çš„ä½“è„‚ç‡ {{detail.fataRate}}%
          </view>
        </view>
      </view>
    </view>
    <view class="wrap-box advise what">
      <view class="t-title how">
        <view class="advice green">{{aimstatus[detail.case.tcTarget].title}}</view>
        <!-- <view class="way">{{tcComputingMethod[detail.case.tcTrialWay]}}</view> -->
      </view>
      <view class="desc">
        æ‰§è¡Œå‘¨æœŸ
        <text>{{detail.case.tcPeriod}}</text>
        å¤©
      </view>
      <view class="desc">
        <view class="type-desc" wx:if="{{detail.case.tcTarget == '01'}}">
          {{detail.case.tcPeriod}}å¤©åªé åƒé¥­ç‡ƒçƒ§
          <text>{{filters.abs(detail.energyDifference)}}</text>
          kcal
        </view>
        <view class="type-desc" wx:if="{{detail.case.tcTarget == '02'}}">
          {{detail.case.tcPeriod}}å¤©å¯ä»¥å¢é‡
          <text>{{filters.abs(detail.energyDifference)}}</text>
          kcal
        </view>
        <view class="type-desc" wx:if="{{detail.case.tcTarget == '03'}}">
          {{detail.case.tcPeriod}}å¤©è®¤çœŸåƒé¥­ï¼Œä¿æŒå®Œç¾ä½“å‹
        </view>
      </view>
      <view class="desc" wx:if="{{detail.case.tcTarget == '01'}}">
        ç›¸å½“äºå‡å»
        <text>{{detail.weight}}</text>
        kgè„‚è‚ª
      </view>
      <view class="desc" wx:if="{{detail.case.tcTarget == '02'}}">
        ç›¸å½“äºå¢åŠ 
        <text>{{detail.weight}}</text>
        kgä½“é‡
      </view>
      <!-- <view class="desc rather">ç›¸å½“äºï¼š</view> -->
      <view class="t-nature line-no" wx:if="{{detail.case.caseLabelList.length>0}}">
        <image class="equal-icon" src="https://prodstatic.weis1606.cn/api/mini/details_bubble_gray.png" />
        <view class="equal-name">ç­‰åŒäº</view>
        <view class="icon-box">
          <view class="t-row" wx:for="{{detail.case.caseLabelList}}" wx:key="key">
            <image src="{{item.tclImgUrl}}" class="icon" />
            <view class="row-value">{{item.tclName}}{{item.num}}{{item.tclUnit}}</view>
          </view>
        </view>
      </view>
    </view>
    <view class="content-w" wx:if="{{detail.case.tcPlanType == '00'}}">
      <view class="sy">é¥®é£Ÿå®‰æ’</view>
      <view class="s-box">
        <swiper class="swiper">
          <block>
            <swiper-item class="i-box" wx:for="{{detail.case.keyArr}}" wx:key="key">
              <view class="b-box" style="background:{{colorArr[index].bg}}">
                <view class="name-c" style="color:{{colorArr[index].color}}">
                  {{categoryObj[item]}}
                </view>
                <view class="c-box">
                  <image src="{{colorArr[index].img}}" />
                  <view class="pie-box" style="border-top: 1px solid {{colorArr[index].bg}}">
                    <view class="pie">
                      <view class="cp-data-pie">
                        <cp-data-pie mode="image" delay="{{400}}" custom-style="width: 138rpx;height: 138rpx;" data="{{detail.case.eachMealMap[item].pieData}}"></cp-data-pie>
                      </view>
                      <view class="element">
                        <view class="circle">
                          <view class="c-bg z"></view>
                          <view class="name">è„‚è‚ª</view>
                          <view class="ele-value">{{detail.case.eachMealMap[item].fat}}%</view>
                        </view>
                        <view class="circle">
                          <view class="c-bg d"></view>
                          <view class="name">è›‹ç™½è´¨</view>
                          <view class="ele-value">{{detail.case.eachMealMap[item].protein}}%</view>
                        </view>
                        <view class="circle">
                          <view class="c-bg t"></view>
                          <view class="name">ç¢³æ°´åŒ–åˆç‰©</view>
                          <view class="ele-value">
                            {{detail.case.eachMealMap[item].carbohydrate}}%
                          </view>
                        </view>
                      </view>
                    </view>
                    <view class="desc">{{detail.case.eachMealMap[item].proverb}}</view>
                  </view>
                </view>
                <view class="tip" style="color:{{colorArr[index].color}}">
                  *å›¾ç‰‡ä»…ä¾›å‚è€ƒï¼Œä¸”ä»…ä¸ºä¸€é¤ç¤ºä¾‹ï¼Œæ¯é¤æ ¹æ®ç®—æ³•æ¨èé£Ÿç‰©ä¸åŒã€‚
                </view>
              </view>
            </swiper-item>
          </block>
        </swiper>
      </view>
      <view class="hd">ğŸ‘ˆå‘å·¦æ»‘åŠ¨æŸ¥çœ‹æ›´å¤š</view>
    </view>
    <!-- æ¯å¤©ä¸åŒ -->
    <view class="content-w" wx:else>
      <view class="sy">é¥®é£Ÿå®‰æ’</view>
      <view class="s-box">
        <swiper class="swiper more">
          <block>
            <swiper-item class="i-box" wx:for="{{detail.caseList}}" wx:key="key" wx:if="{{index < 7}}">
              <view class="b-box" style="background:{{colorArr[index].bg}}">
                <view class="name-c" style="color:{{colorArr[index].color}}">
                  DAY {{filters.addZero(index+1)}}
                </view>
                <view class="c-box">
                  <image src="{{colorArr[index].img}}" />
                  <view class="pie-box" style="border-top: 1px solid {{colorArr[index].bg}}">
                    <view class="pie" wx:for="{{item.keyArr}}" wx:key="key" wx:for-item="category">
                      <view class="name-cat">{{categoryObj[category]}}</view>
                      <view class="cp-data-pie">
                        <cp-data-pie mode="image" delay="{{400}}" custom-style="width: 138rpx;height: 138rpx;" data="{{item.eachMealMap[category].pieData}}"></cp-data-pie>
                      </view>
                      <view class="element">
                        <view class="circle">
                          <view class="c-bg z"></view>
                          <view class="name">è„‚è‚ª</view>
                          <view class="ele-value">{{item.eachMealMap[category].fat}}%</view>
                        </view>
                        <view class="circle">
                          <view class="c-bg d"></view>
                          <view class="name">è›‹ç™½è´¨</view>
                          <view class="ele-value">{{item.eachMealMap[category].protein}}%</view>
                        </view>
                        <view class="circle">
                          <view class="c-bg t"></view>
                          <view class="name">ç¢³æ°´åŒ–åˆç‰©</view>
                          <view class="ele-value">
                            {{item.eachMealMap[category].carbohydrate}}%
                          </view>
                        </view>
                      </view>
                    </view>
                  </view>
                </view>
                <view class="tip" style="color:{{colorArr[index].color}}">
                  *å›¾ç‰‡ä»…ä¾›å‚è€ƒï¼Œä¸”ä»…ä¸ºä¸€é¤ç¤ºä¾‹ï¼Œæ¯é¤æ ¹æ®ç®—æ³•æ¨èé£Ÿç‰©ä¸åŒã€‚
                </view>
              </view>
            </swiper-item>
          </block>
        </swiper>
      </view>
      <view class="hd">ğŸ‘ˆå‘å·¦æ»‘åŠ¨æŸ¥çœ‹{{detail.caseList.length > 7 ? 7 : detail.caseList.length}}å¤©</view>
    </view>
    <image class="long1" src="https://prodstatic.weis1606.cn/api/mini/exclusive.png" />
    <image class="long1 long2" src="https://prodstatic.weis1606.cn/api/mini/cook.png" />
    <!-- ç®€ä»‹ -->
    <view class="intro">
      <view class="intro-title">è¥å…»å¸ˆä»‹ç»</view>
      <view class="head">
        <image src="{{detail.case.dietician.tcdImgUrl}}" />
        <view class="name-box">
          <view class="name">{{detail.case.dietician.tcdName}}</view>
          <view class="profession">{{detail.case.dietician.tcdTitle}}</view>
          <view class="profession-box">
            <view class="pro" wx:for="{{detail.case.dietician.tcdIntroduce}}" wx:key="key">
              {{item}}
            </view>
          </view>
        </view>
      </view>
    </view>
    <image class="long1 long3" src="https://prodstatic.weis1606.cn/api/mini/implement.png" />
    <image class="long1 long4" src="https://prodstatic.weis1606.cn/api/mini/make.png" />
    <view class="jc">æˆ‘ä»¬ä¸€ç›´åšæŒ</view>
    <image class="long1 long5" src="https://prodstatic.weis1606.cn/api/mini/insist_chart.png" />
    <!-- <image class="long" src="{{detail.longPhoto}}" /> -->
  </view>
</view>
<view class="bot-box" hidden="{{check}}">
  <view wx:if="{{showReserve}}" class="btn button--primary" bind:tap="reverseTap">é¢„çº¦å…¥è¥</view>
  <view wx:else class="btn button--primary btn--library">
    <view class="btn-l" bind:tap="use">ä½¿ç”¨åƒæ³•</view>
    <view class="btn-r" bind:tap="goMultiMeal">ç«‹å³ç‚¹é¤</view>
  </view>
</view>
<view class="date-dialog" catch:touchmove="true" wx:if="{{showMultiSelect}}">
  <view class="popupshow" wx:if="{{showMultiSelect}}" catch:touchmove="true">
    <view class="title">é€‰æ‹©æ‰§è¡Œæ—¶é—´</view>
    <multiSelect-calendar id="multiSelect" calendarConfig="{{calendarConfig}}" bind:onSwipe="onSwipe" bind:onTapDay="onTapDay" bind:afterTapDay="afterTapDay" bind:whenChangeMonth="whenChangeMonth" bind:afterCalendarRender="afterCalendarRender"></multiSelect-calendar>
    <view class="btn">
      <view class="sure an {{canClick ? 'active' : ''}}" bind:tap="sureSelect">ä½¿ç”¨åƒæ³•å³åˆ»è®¢é¤</view>
    </view>
    <image class="close" src="/images/logistics_popup_off.png" bind:tap="cancelSelect" />
  </view>
</view>
<!-- <cp-rb-calendar id="calendar" show="{{showMultiSelect}}" bind:select="selectDate" bind:close="closeFn" /> -->
<!-- ä½¿ç”¨åƒæ³•è®¢é¤ï¼Œå®Œæˆå…¥è¥æœ€åä¸€æ­¥ã€‚ -->
<view class="tip-b" wx:if="{{showReserve}}">
  <image src="https://prodstatic.weis1606.cn/api/activity/tips_ip_icon.png" />
  <view class="title">ä½¿ç”¨åƒæ³•è®¢é¤ï¼Œå®Œæˆå…¥è¥æœ€åä¸€æ­¥ã€‚</view>
</view>